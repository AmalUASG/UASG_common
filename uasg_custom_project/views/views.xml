<odoo>
  <data>


  <record model="ir.ui.view" id="project_update_list">
      <field name="name">Projects Updates</field>
      <field name="model">uasg.project.update</field>

      <field name="arch" type="xml">
        <tree>
           <field name="date" />
            <field name="name" />
            <field name="implementation_dependancy"  />
            <field name="create_uid" string="Owner"/>
      </tree>
  </field>
</record>



<record model="ir.actions.act_window" id="project_update_action_window">
  <field name="name">project Updates</field>
  <field name="type">ir.actions.act_window</field>
  <field name="res_model">uasg.project.update</field>
  <field name="view_mode">tree</field>
  <field name="view_id" ref="project_update_list"/>
</record>


  

    <record model="ir.ui.view" id="project_list">
      <field name="name">Projects list</field>
      <field name="model">uasg.project</field>

      <field name="arch" type="xml">
        <tree>
          <field name="name" />
          <field name="assigned_to"/>
          <field name="vendor"  />
          <field name="target_date"/>
          <field name="status" invisible="1"/>
          <field name="status" widget="badge" decoration-success="status=='completed'" decoration-warning="status=='in_progress'" />
      </tree>
  </field>
</record>





<record model="ir.ui.view" id="project_form">
  <field name="name">Project </field>
  <field name="model">uasg.project</field>
  <field name="arch" type="xml">
    <form>

        <header>
         
         <button name="action_submit" string="Submit" type="object" class="oe_highlight" attrs="{'invisible': [('status', '!=', 'draft')]}" groups="uasg_custom_project.group_project_manager"/>

         <button name="action_pipeline" string="Approve" type="object" class="oe_highlight" attrs="{'invisible': [('status', '!=', 'in_progress')]}" groups="uasg_custom_project.group_project_manager"/>

         <button name="action_completed" string="Completed" type="object" class="oe_highlight" attrs="{'invisible': [('status', '!=', 'pipeline')]}" groups="uasg_custom_project.group_project_manager"/>

         <field name="status" widget="statusbar"/>

     </header>

     <sheet>
       <!--  <header>
            <button name="%(project_update_action_window)d" string="Add an Update" type="action" 
            context="{'default_project_id': id}"/>
        </header> -->
      <div class="oe_title">
        <label for="name" string="Subject" attrs="{'readonly':['|',('status','=','completed'),('make_fields_read_only' , '=' , True)]}" />
        <h1>
            <field class="text-break" name="name" placeholder="Project Title" required="1" attrs="{'readonly':['|',('status','=','completed'),('make_fields_read_only' , '=' , True)]}"  />
        </h1>
        <div>
            <field name="tag_ids" widget="many2many_tags" options="{'color_field': 'color'}" placeholder="Tags" style="width: 100%"  attrs="{'readonly':['|',('status','=','completed'),('make_fields_read_only' , '=' , True)]}"  />
        </div>
    </div>
    <group>
        <group>
            <field name="make_fields_read_only" invisible="1"/>
            <field name="date" attrs="{'readonly':['|',('status','=','completed'),('make_fields_read_only' , '=' , True)]}" />
        <field name="assigned_to" required="1" widget="many2one_avatar_user" attrs="{'readonly':['|',('status','=','completed'),('make_fields_read_only' , '=' , True)]}" />
        <field name="vendor" attrs="{'readonly':['|',('status','=','completed'),('make_fields_read_only' , '=' , True)]}" />
        <field name="target_date" attrs="{'readonly':['|',('status','=','completed'),('make_fields_read_only' , '=' , True)]}" />
    </group>
 
</group>

<notebook >
    <page string="Description" name="description" >
        <field name = "description" widget="html" attrs="{'readonly':['|',('status','=','completed'),('make_fields_read_only' , '=' , True)]}" />

    </page>
    <page string ="Project Updates" name="project_updates">
      <field name="project_updates" attrs="{'readonly':[('status','=','completed')]}" widget="section_and_note_one2many"  mode="tree,kanban" >
        <tree string="Updates" editable="bottom" >
            <field name="date" />
            <field name="name" />
            <field name="implementation_dependancy"  />
            <field name="create_uid" string="Owner"/>

        </tree>
    </field>
</page>
</notebook>
</sheet>
<div class="oe_chatter">
    <field name="message_follower_ids"/>
    <field name="message_ids"/>
</div>
</form>
</field>
</record>




<record model="ir.actions.act_window" id="project_action_window">
  <field name="name">project</field>
  <field name="type">ir.actions.act_window</field>
  <field name="res_model">uasg.project</field>
  <field name="view_mode">tree,form</field>
</record>



<record model="ir.actions.act_window" id="project_mail_templates_action_window">
  <field name="name">Email Templates</field>
  <field name="type">ir.actions.act_window</field>
  <field name="res_model">mail.template</field>
  <field name="view_mode">tree,form</field>
  <field name="domain">[('model_id','=','uasg.project')]</field>
  <field name="context">{'create':0,'delete':0}</field>


</record>





<menuitem
    id="project_main_menu"
    name="Project"
    groups="group_project_manager,group_project_user"
    sequence="1"
    web_icon="uasg_custom_project,static/description/icon.png"
    />

    <!-- menu categories -->


    <menuitem name="Project" id="project" sequence = "1" parent="project_main_menu" action="project_action_window" />

    <menuitem name="Configuration" id="project_configuration" sequence = "2" parent="project_main_menu" groups="base.group_system" />

    <menuitem name="E-mail Templates" id="email_templates" sequence = "1" parent="project_configuration" action="project_mail_templates_action_window" />



  </data>
</odoo>